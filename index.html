<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Predict Color</title>
  <style>
    body {
      background: #111;
      color: #0f0;
      font-family: monospace;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      flex-direction: column;
    }
    input {
      width: 92%;
      max-width: 680px;
      padding: 12px;
      background: #000;
      color: #0f0;
      border: 1px solid #0f0;
      font-family: monospace;
      font-size: 16px;
      box-sizing: border-box;
    }
    #output {
      margin-top: 18px;
      white-space: pre-wrap;
      font-size: 18px;
      min-height: 24px;
    }
  </style>
</head>
<body>
  <input id="command" placeholder="(predict)color) type what you want to predict color" autofocus />
  <div id="output"></div>

  <script>
    const ALLOWED = ["red","orange","yellow","green","blue","purple"];
    const BASE_SEQ = ["red","orange","yellow","green","blue","purple"];

    function parseCommand(text) {
      const rx = /\(predict\)color\)\s*\(([^)]+)\)/i;
      const m = text.match(rx);
      if (!m) return null;
      const inside = m[1];
      const toks = inside.split(/\s+/).map(s => s.trim().toLowerCase()).filter(Boolean);
      const valid = toks.filter(t => ALLOWED.includes(t));
      return valid.length ? valid : null;
    }

    function buildTransitions(seq) {
      const trans = {};
      for (let i = 0; i < seq.length - 1; i++) {
        const a = seq[i], b = seq[i+1];
        trans[a] = trans[a] || {};
        trans[a][b] = (trans[a][b] || 0) + 1;
      }
      return trans;
    }

    function chooseNext(trans, last) {
      if (trans[last]) {
        const entries = Object.entries(trans[last]);
        entries.sort((a,b) => b[1] - a[1]);
        return entries[0][0];
      }
      const idx = BASE_SEQ.indexOf(last);
      if (idx === -1) return BASE_SEQ[0];
      return BASE_SEQ[(idx + 1) % BASE_SEQ.length];
    }

    function predictNextN(inputColors, n = 4) {
      const combined = BASE_SEQ.concat(inputColors);
      const trans = buildTransitions(combined);
      const preds = [];
      let last = inputColors[inputColors.length - 1];
      for (let i = 0; i < n; i++) {
        const next = chooseNext(trans, last);
        preds.push(next);
        trans[last] = trans[last] || {};
        trans[last][next] = (trans[last][next] || 0) + 1;
        last = next;
      }
      return preds;
    }

    const inputEl = document.getElementById("command");
    const outputEl = document.getElementById("output");

    inputEl.addEventListener("keydown", (e) => {
      if (e.key !== "Enter") return;
      e.preventDefault();
      const txt = inputEl.value.trim();
      const seq = parseCommand(txt);
      if (!seq) {
        outputEl.textContent = "Invalid â€” use (predict)color) (red blue green ...)";
        return;
      }
      const preds = predictNextN(seq, 4);
      outputEl.textContent = preds.join(", ");
    });
  </script>
</body>
</html>
